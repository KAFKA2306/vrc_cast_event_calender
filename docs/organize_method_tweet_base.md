# イベント名抽出戦略の全体設計（具体的・詳細版）

本戦略は、Twitterデータから多様なイベント告知・レポート・参加案内ツイートを対象に、**高精度かつ再利用性の高い「イベント名」抽出**を実現するためのアルゴリズム全体設計です。  
添付された実データと既存コード、そしてAIによる意見を総合し、実運用に耐える具体的なプロセスを示します。

---

## 1. データ前処理・正規化

- **Unicode正規化**・不要制御文字除去・全角/半角統一を徹底し、ノイズを減らす。
- ツイート本文を**行ごとに分割**し、空行や不要な前置き（例：「おはよ～」「さて今夜は」など）を除去。
- **イベント告知ブロック**（例：「さて今夜は」以降や、最初の時間表記以降）を抽出し、雑談や余談と分離する。

---

## 2. イベントブロックの検出

- 1ツイートに複数イベントが混在するケースが多いため、**時間表記（例：21:00、20:55-22:00）ごとにイベントブロックを分割**する。
- 各ブロックは「開始時刻」「終了時刻」「詳細テキスト（イベント名・参加方法・リクイン先など）」を持つ構造とする。
- 時間表記がない場合は、ハッシュタグやタイトル行からイベント性を判定する。

---

## 3. イベント名候補の抽出（多段階）

### a. 鉤括弧・装飾記号パターン

- 各行から「『』」「「」」「【】」「“”」など**装飾記号で囲まれたテキスト**を優先的に抽出。
- ただし、「新人メンバー」「初回」「限定」など**説明や役割語のみ**の場合は除外する。

### b. 時間表記直後・直前の行

- **時間表記直後の行**を最優先でイベント名候補とする（例：「21:00\nWonder Teaparty」→「Wonder Teaparty」）。
- 直前行も候補とし、複数行にまたがるタイトル（例：「LUNA REAL -virtual cabaret club 1部」）も許容する。

### c. ハッシュタグからの抽出

- **#イベント名**形式のハッシュタグも候補とするが、「#イベント」「#event」など一般語は除外。
- ハッシュタグは重複・ノイズ除去した上で、他候補と比較する。

### d. 英数字・カタカナ・漢字混在型

- 「LapDance CLUB -Spirit Motion-1部」など、**複数言語・記号混在パターン**も有効候補とする。
- 「vol.」「第1部」「1st」など**部数・回数表記**はイベント名の一部として残す。

---

## 4. ノイズ除去・正規化

- **参加方法・リクイン先・抽選・Join等の文言**が主語・述語となる行は除外。
- **ユーザーID/インスタンス名のみ**（例：「yagupiに」）や「当日発表」「初回」「限定」など説明語のみも除外。
- イベント名末尾の「(Join)」「(リクイン)」などは、**参加方法であれば除去**、部数やイベント名の一部なら残す。
- 1～2文字の短すぎるもの、一般語（「イベント」など）は候補から除外する。

---

## 5. 優先順位付け・出力フォーマットの統一

- 候補が複数ある場合は、**優先度：鉤括弧＞時間直後行＞時間直前行＞ハッシュタグ**とする。
- **より長く具体的なもの**を優先（例：「LUNA REAL」より「LUNA REAL -virtual cabaret club 1部」）。
- 出力は「イベント名」「開催日時」「参加方法」「リクイン先」など**再利用性の高い構造体**で返す。

---

## 6. 例外・特殊パターン対応

- **複数イベント連続記載**や**訂正ツイート**は、前後ツイートや引用元も参照し、重複や誤記を排除。
- 「イベント名：説明文」形式は、コロン前をイベント名とみなす。
- 「#BUNNYSPACE の夏イベント」など**ハッシュタグ＋説明文**もセットで認識。

---

## 7. 継続的な精度向上のための運用

- **抽出成功例・失敗例のリスト化**によりルールを随時チューニング。
- テストケースを多様な表現パターンで用意し、**自動検証プロセス**を組み込む。
- **新規パターンやノイズ**が発見された場合は、正規表現や除外ルールを即時アップデート。

---

## 8. アルゴリズム全体フロー（概要）

```plaintext
1. データ正規化・行分割
2. イベントブロック（時間表記単位）に分割
3. 各ブロックで
    a. 鉤括弧・装飾記号内テキスト抽出
    b. 時間直後・直前行から候補抽出
    c. ハッシュタグから候補抽出
    d. 英数字・カタカナ・漢字混在型も候補に
4. ノイズ除去・正規化
5. 優先順位付け・出力フォーマット統一
6. 例外処理（訂正・複数イベント・説明文パターン等）
7. 継続的なルール改善・自動検証
```

---

## 9. 具体的な抽出例

- **ツイート例1**  
  ```
  21:00
  LUNA REAL -virtual cabaret club 1部
  rumaruLunarealへリクイン
  ```
  → イベント名：「LUNA REAL -virtual cabaret club 1部」

- **ツイート例2**  
  ```
  21:55
  Ravissa
  ILにリクイン
  ```
  → イベント名：「Ravissa」

- **ツイート例3**  
  ```
  #BUNNYSPACE の夏イベントスタート
  21:55リクイン開始だよ！
  ```
  → イベント名：「BUNNYSPACE の夏イベントスタート」

---

## 10. 今後の拡張・応用

- **他SNSや公式サイトのイベント情報**にも横展開可能な柔軟な設計。
- **多言語対応**や**画像からのOCR抽出**との組み合わせも視野に入れる。
- **AIによる自動ラベル付けやクラスタリング**と連携し、抽出精度をさらに高める。

---

## まとめ

この戦略は、現実の多様なイベント告知ツイート・ノイズ・複数イベント混在・訂正・特殊表現などをカバーし、  
「イベント名」を中心とした構造化データを**高精度・高再利用性**で抽出するための**実践的かつ拡張性の高い設計**です。  
今後も新しいパターンやノイズに柔軟に対応し、継続的な改善を行うことで、業務・分析・自動化において強力な基盤となります。